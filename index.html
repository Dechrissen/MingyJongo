<!DOCTYPE html>
<html>
<head>
	<title>MingyJongo OAuth2</title>
</head>
<body>
	<div id="info">
		<h1>MingyJongo OAuth2</h1>
	</div>
  <p style="display: inline;">Link your Discord and Twitch accounts for Croissant access:</p> <a id="login" style="display: none;" href="https://discord.com/api/oauth2/authorize?client_id=822534331079327803&redirect_uri=https%3A%2F%2Fderekandersen.net%2Fmingy-jongo-auth&response_type=code&scope=identify%20connections">Authorize</a>
	<script>
	function generateRandomString() {
		const rand = Math.floor(Math.random() * 10);
		let randStr = '';

		for (let i = 0; i < 20 + rand; i++) {
			randStr += String.fromCharCode(33 + Math.floor(Math.random() * 94));
		}

		return randStr;
	}

	window.onload = () => {

		const randStr = generateRandomString();
		localStorage.setItem('stateParameter', randStr);
		document.getElementById('login').href += `&state=${encodeURIComponent(btoa(randStr))}`;
		document.getElementById('login').style.display = 'inline-block';

	}
	</script>
</body>
</html>
