<!DOCTYPE html>
<html>
<head>
	<link rel="icon" type="image/png" href="/assets/images/mingy-icon.png" />
	<title>MingyJongo OAuth2</title>
</head>
<body>
	<div id="info">
		<h1>MingyJongo OAuth2</h1>
	</div>
  <p style="display: inline;">Link your Twitch account for croissant access:</p> <a id="login" style="display: none;" href="https://discord.com/api/oauth2/authorize?client_id=822534331079327803&redirect_uri=http%3A%2F%2Flocalhost%3A53134&response_type=code&scope=connections%20identify">Authorize</a>
	<script>
	function generateRandomString() {
			const rand = Math.floor(Math.random() * 10);
			let randStr = '';

			for (let i = 0; i < 20 + rand; i++) {
				randStr += String.fromCharCode(33 + Math.floor(Math.random() * 94));
			}

			return randStr;
		}

		window.onload = () => {

				const randStr = generateRandomString();
				localStorage.setItem('stateParameter', randStr);

				document.getElementById('login').href += `&state=${encodeURIComponent(btoa(randStr))}`;
				document.getElementById('login').style.display = 'inline-block';

		}
	</script>
</body>
</html>
